#!/bin/bash

# å½“ä»»ä½•å‘½ä»¤å¤±è´¥æ—¶ï¼Œç«‹å³é€€å‡ºè„šæœ¬
set -e

# --- 1. è·å–ç”¨æˆ·è¾“å…¥çš„ Commit Message ---
echo "ğŸš€ å¼€å§‹æ‰§è¡Œ Hexo åšå®¢ä¸€é”®éƒ¨ç½²è„šæœ¬..."
echo

echo "è¯·è¾“å…¥æœ¬æ¬¡æäº¤çš„æè¿°ä¿¡æ¯ (ç›´æ¥å›è½¦å°†ä½¿ç”¨é»˜è®¤å€¼ 'docs: Update content'):"
read -r commit_message

# å¦‚æœç”¨æˆ·è¾“å…¥ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„ commit message
if [ -z "$commit_message" ]; then
    commit_message="docs: Update content"
fi

echo "âœ… ä½¿ç”¨ Commit Message: '$commit_message'"
echo "----------------------------------------"


# --- 2. æ‰§è¡Œéƒ¨ç½²æµç¨‹ ---

echo "â¡ï¸ æ­¥éª¤ 1/4: æ­£åœ¨ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°æ›´æ”¹ (git pull)..."
# å¦‚æœ git pull å¤±è´¥ (ä¾‹å¦‚æœ‰åˆå¹¶å†²çª), 'set -e' ä¼šè®©è„šæœ¬åœ¨è¿™é‡Œåœæ­¢
git pull
echo "âœ… Git Pull æˆåŠŸã€‚"
echo "----------------------------------------"

echo "â¡ï¸ æ­¥éª¤ 2/4: æ­£åœ¨å°†æ‰€æœ‰æ›´æ”¹æ·»åŠ åˆ° Git (git add .)..."
git add .
echo "âœ… æ–‡ä»¶æ·»åŠ å®Œæˆã€‚"
echo "----------------------------------------"

echo "â¡ï¸ æ­¥éª¤ 3/4: æ­£åœ¨æäº¤æœ¬åœ°æ›´æ”¹ (git commit)..."
git commit -m "$commit_message"
echo "âœ… æäº¤æˆåŠŸã€‚"
echo "----------------------------------------"

echo "â¡ï¸ æ­¥éª¤ 4/4: æ­£åœ¨æ¨é€åˆ°è¿œç¨‹æºæ–‡ä»¶ä»“åº“ (git push)..."
# å¦‚æœä½ çš„ä¸»åˆ†æ”¯ä¸æ˜¯ mainï¼Œè¯·ä¿®æ”¹ä¸‹é¢çš„ "main"
git push origin main
echo "âœ… æ¨é€æˆåŠŸã€‚"
echo "----------------------------------------"

echo "ğŸ‰ å…¨éƒ¨æµç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œéƒ¨ç½²åœ†æ»¡å®Œæˆï¼"